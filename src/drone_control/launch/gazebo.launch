<launch>
    <param name="/use_sim_time" value="true" />
    <!-- Gazebo环境下无需开启真实相机节点 -->
    <!-- 直接使用Gazebo仿真环境提供的相机话题 -->

    <!-- 下视相机ArUco检测 -->
    <group ns="down_aruco_tracker">
        <node pkg="aruco_detect" type="aruco_detect" name="aruco_detect">
            <remap from="camera" to="/iris_front_down_camera/usb_cam/image_raw" />
            <remap from="camera_info" to="/iris_front_down_camera/usb_cam/camera_info" />
            <remap from="/fiducial_images" to="/down_aruco_tracker/fiducial_images" />

            <param name="publish_images" value="true"/>
            <param name="fiducial_len" value="0.5"/> 
            <param name="fiducial_len_override" value="42: 0.1"/>
            <param name="image_is_rectified" value="false"/>
            <param name="dictionary"   value="10"/>    
        </node>
    </group>
    <group ns="down_tracker_child">
        <node pkg="aruco_detect" type="aruco_detect" name="aruco_detect">
            <remap from="camera" to="/iris_front_down_camera/usb_cam/image_raw" />
            <remap from="camera_info" to="/iris_front_down_camera/usb_cam/camera_info" />

            <param name="publish_images" value="false"/>
            <param name="fiducial_len" value="0.05"/> 
            <param name="image_is_rectified" value="false"/>
            <param name="dictionary"   value="10"/>    
        </node>
    </group>

    <node pkg="drone_control" type="drone_control_node" name="drone_control_node" output="screen">
    </node>
    <!-- <node type="rviz" name="rviz" pkg="rviz" args="-d $(find aruco_detect)/launch/aruco_config.rviz" /> -->

    <!-- 下视相机图像查看器 -->
    <node pkg="rqt_image_view" type="rqt_image_view" name="down_camera_viewer" output="screen">
        <param name="image_topic" value="/down_aruco_tracker/fiducial_images" />
    </node>

    <!-- ArUco板检测节点 -->
    <include file="$(find board_detect)/launch/board_detect.launch">
        <!-- 可以在这里覆盖默认参数 -->
        <arg name="camera_topic"       value="/iris_front_down_camera/camera/rgb/image_raw" />
        <arg name="camera_info_topic"  value="/iris_front_down_camera/camera/rgb/camera_info" />
        <arg name="markers_x"          value="2" />
        <arg name="markers_y"          value="2" />
        <arg name="marker_length"      value="0.04" />
        <arg name="marker_separation"  value="0.01" />
        <arg name="dictionary_id"      value="0" />
        <arg name="show_debug_image"   value="true" />
    </include>

</launch>
